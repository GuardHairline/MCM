#!/bin/bash
#===============================================================================
# 快速测试脚本
# 用途：测试项目是否可以正常运行
# 设置：epoch=2, batch_size=4, 策略=NONE
# 任务：8个任务 (4个text-only + 4个multimodal)
#===============================================================================

set -e

# 获取脚本所在目录
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../../.." && pwd)"

# 切换到项目根目录
cd "$PROJECT_ROOT"

echo "==============================================================================="
echo "快速测试 - 开始"
echo "==============================================================================="
echo "项目根目录: $PROJECT_ROOT"
echo "配置文件: scripts/configs/quick_test/quick_test_config.json"
echo "任务数: 8"
echo ""

# 运行所有任务
echo "==============================================================================="
echo "运行 8 个任务..."
echo "==============================================================================="
python -m scripts.train_with_zero_shot \
    --config scripts/configs/quick_test/quick_test_config.json \
    --start_task 0 \
    --end_task 8

if [ $? -ne 0 ]; then
    echo "❌ 测试失败！"
    exit 1
fi

echo "==============================================================================="
echo "✅ 快速测试完成！所有任务运行成功"
echo "==============================================================================="
